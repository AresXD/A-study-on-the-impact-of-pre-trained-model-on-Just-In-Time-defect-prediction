(network) root@f568504f151e:/data/py_project_500/Lora# python run.py -bart_model -train -original
torch.Size([1, 768])
train bart-base model
CUDA_VISIBLE_DEVICES=2 python plbart.py -train -train_data ../data/qt_data/qt_train.pkl -save-dir bart_snapshot/original/qt -dictionary_data ../data/qt_dict.pkl
20563 20563
 max length at tokenizer: 256
 max length for code tokenizer: 120
20563 20563 20563
pad_msg_input_ids (20563, 256)
pad_msg_input_masks (20563, 256)
pad_code_input_ids (20563, 4, 120)
pad_code_input_masks (20563, 4, 120)
Some weights of BartForSequenceClassification were not initialized from the model checkpoint at facebook/bart-base and are newly initialized: ['classification_head.out_proj.bias', 'classification_head.out_proj.weight', 'classification_head.dense.bias', 'classification_head.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
  8%|█████████████████▋                                                                                                                                                                                                                   | 99/1286 [00:38<07:11,  2.75it/s]Epoch 1 / 3  the step 100-- Total loss: 66.822174
 15%|███████████████████████████████████▎                                                                                                                                                                                                | 199/1286 [01:14<06:43,  2.69it/s]Epoch 1 / 3  the step 200-- Total loss: 61.972702
 23%|█████████████████████████████████████████████████████                                                                                                                                                                               | 299/1286 [01:51<06:08,  2.68it/s]Epoch 1 / 3  the step 300-- Total loss: 55.782585
 31%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                             | 399/1286 [02:30<05:42,  2.59it/s]Epoch 1 / 3  the step 400-- Total loss: 55.296535
 39%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                           | 499/1286 [03:08<04:55,  2.66it/s]Epoch 1 / 3  the step 500-- Total loss: 54.505817
 47%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                         | 599/1286 [03:46<04:17,  2.66it/s]Epoch 1 / 3  the step 600-- Total loss: 51.730824
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                        | 699/1286 [04:24<03:41,  2.65it/s]Epoch 1 / 3  the step 700-- Total loss: 45.597084
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 799/1286 [05:01<03:03,  2.65it/s]Epoch 1 / 3  the step 800-- Total loss: 47.190140
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 899/1286 [05:39<02:26,  2.64it/s]Epoch 1 / 3  the step 900-- Total loss: 45.002460
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 999/1286 [06:17<01:48,  2.65it/s]Epoch 1 / 3  the step 1000-- Total loss: 44.316177
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1099/1286 [06:55<01:10,  2.64it/s]Epoch 1 / 3  the step 1100-- Total loss: 41.498589
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1199/1286 [07:33<00:32,  2.67it/s]Epoch 1 / 3  the step 1200-- Total loss: 35.707104
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1286/1286 [08:07<00:00,  2.64it/s]
path: bart_snapshot/original/qt/epoch_1_step_1286.pt
  8%|█████████████████▋                                                                                                                                                                                                                   | 99/1286 [00:36<07:22,  2.69it/s]Epoch 2 / 3  the step 100-- Total loss: 30.674763
 15%|███████████████████████████████████▎                                                                                                                                                                                                | 199/1286 [01:14<06:48,  2.66it/s]Epoch 2 / 3  the step 200-- Total loss: 29.308235
 23%|█████████████████████████████████████████████████████                                                                                                                                                                               | 299/1286 [01:51<06:09,  2.67it/s]Epoch 2 / 3  the step 300-- Total loss: 26.978199
 31%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                             | 399/1286 [02:29<05:35,  2.64it/s]Epoch 2 / 3  the step 400-- Total loss: 25.195345
 39%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                           | 499/1286 [03:07<04:56,  2.66it/s]Epoch 2 / 3  the step 500-- Total loss: 25.869787
 47%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                         | 599/1286 [03:45<04:18,  2.66it/s]Epoch 2 / 3  the step 600-- Total loss: 21.586594
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                        | 699/1286 [04:23<03:41,  2.65it/s]Epoch 2 / 3  the step 700-- Total loss: 20.718254
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 799/1286 [05:01<03:03,  2.65it/s]Epoch 2 / 3  the step 800-- Total loss: 16.263136
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 899/1286 [05:39<02:25,  2.66it/s]Epoch 2 / 3  the step 900-- Total loss: 14.732495
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 999/1286 [06:17<01:48,  2.65it/s]Epoch 2 / 3  the step 1000-- Total loss: 14.862995
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1099/1286 [06:55<01:11,  2.62it/s]Epoch 2 / 3  the step 1100-- Total loss: 13.597212
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1199/1286 [07:33<00:32,  2.66it/s]Epoch 2 / 3  the step 1200-- Total loss: 12.705349
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1286/1286 [08:06<00:00,  2.64it/s]
path: bart_snapshot/original/qt/epoch_2_step_1286.pt
  8%|█████████████████▋                                                                                                                                                                                                                   | 99/1286 [00:36<07:25,  2.66it/s]Epoch 3 / 3  the step 100-- Total loss: 11.066616
 15%|███████████████████████████████████▎                                                                                                                                                                                                | 199/1286 [01:14<06:50,  2.65it/s]Epoch 3 / 3  the step 200-- Total loss: 8.658845
 23%|█████████████████████████████████████████████████████                                                                                                                                                                               | 299/1286 [01:52<06:11,  2.66it/s]Epoch 3 / 3  the step 300-- Total loss: 8.222505
 31%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                             | 399/1286 [02:30<05:36,  2.64it/s]Epoch 3 / 3  the step 400-- Total loss: 9.002036
 39%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                           | 499/1286 [03:08<05:00,  2.62it/s]Epoch 3 / 3  the step 500-- Total loss: 7.452548
 47%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                         | 599/1286 [03:46<04:18,  2.65it/s]Epoch 3 / 3  the step 600-- Total loss: 5.418155
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                        | 699/1286 [04:24<03:43,  2.62it/s]Epoch 3 / 3  the step 700-- Total loss: 6.780645
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 799/1286 [05:02<03:02,  2.67it/s]Epoch 3 / 3  the step 800-- Total loss: 6.073572
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 899/1286 [05:40<02:21,  2.73it/s]Epoch 3 / 3  the step 900-- Total loss: 5.377345
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 999/1286 [06:18<01:47,  2.66it/s]Epoch 3 / 3  the step 1000-- Total loss: 4.377139
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1099/1286 [06:56<01:10,  2.64it/s]Epoch 3 / 3  the step 1100-- Total loss: 4.635336
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1199/1286 [07:34<00:32,  2.65it/s]Epoch 3 / 3  the step 1200-- Total loss: 4.226482
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1286/1286 [08:07<00:00,  2.64it/s]
path: bart_snapshot/original/qt/epoch_3_step_1286.pt
final loss :  [66.82217407226562, 61.97270202636719, 55.78258514404297, 55.29653549194336, 54.50581741333008, 51.7308235168457, 45.597084045410156, 47.19013977050781, 45.00246047973633, 44.31617736816406, 41.49858856201172, 35.70710372924805, 30.674762725830078, 29.30823516845703, 26.978199005126953, 25.195344924926758, 25.869787216186523, 21.586593627929688, 20.71825408935547, 16.26313591003418, 14.732495307922363, 14.862995147705078, 13.597211837768555, 12.70534896850586, 11.06661605834961, 8.658844947814941, 8.222504615783691, 9.002036094665527, 7.452548027038574, 5.418154716491699, 6.78064489364624, 6.073571681976318, 5.377344608306885, 4.377139091491699, 4.635335922241211, 4.226481914520264]
CUDA_VISIBLE_DEVICES=2 python plbart.py -train -train_data ../data/openstack_data/openstack_train.pkl -save-dir bart_snapshot/original/openstack -dictionary_data ../data/openstack_dict.pkl
10643 10643
 max length at tokenizer: 256
 max length for code tokenizer: 120
10643 10643 10643
pad_msg_input_ids (10643, 256)
pad_msg_input_masks (10643, 256)
pad_code_input_ids (10643, 4, 120)
pad_code_input_masks (10643, 4, 120)
Some weights of BartForSequenceClassification were not initialized from the model checkpoint at facebook/bart-base and are newly initialized: ['classification_head.out_proj.weight', 'classification_head.dense.weight', 'classification_head.dense.bias', 'classification_head.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
 15%|██████████████████████████████████▏                                                                                                                                                                                                   | 99/666 [00:38<03:30,  2.70it/s]Epoch 1 / 3  the step 100-- Total loss: 66.956276
 30%|████████████████████████████████████████████████████████████████████▍                                                                                                                                                                | 199/666 [01:15<02:54,  2.67it/s]Epoch 1 / 3  the step 200-- Total loss: 60.648869
 45%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                              | 299/666 [01:53<02:19,  2.64it/s]Epoch 1 / 3  the step 300-- Total loss: 56.960300
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                           | 399/666 [02:31<01:41,  2.64it/s]Epoch 1 / 3  the step 400-- Total loss: 54.055771
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 499/666 [03:09<01:02,  2.65it/s]Epoch 1 / 3  the step 500-- Total loss: 56.346260
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 599/666 [03:47<00:25,  2.64it/s]Epoch 1 / 3  the step 600-- Total loss: 53.139973
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 666/666 [04:12<00:00,  2.64it/s]
path: bart_snapshot/original/openstack/epoch_1_step_666.pt
 15%|██████████████████████████████████▏                                                                                                                                                                                                   | 99/666 [00:37<03:29,  2.71it/s]Epoch 2 / 3  the step 100-- Total loss: 49.557148
 30%|████████████████████████████████████████████████████████████████████▍                                                                                                                                                                | 199/666 [01:15<02:56,  2.65it/s]Epoch 2 / 3  the step 200-- Total loss: 45.538845
 45%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                              | 299/666 [01:53<02:18,  2.64it/s]Epoch 2 / 3  the step 300-- Total loss: 43.740612
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                           | 399/666 [02:31<01:41,  2.64it/s]Epoch 2 / 3  the step 400-- Total loss: 42.261253
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 499/666 [03:09<01:03,  2.65it/s]Epoch 2 / 3  the step 500-- Total loss: 37.795414
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 599/666 [03:47<00:25,  2.63it/s]Epoch 2 / 3  the step 600-- Total loss: 37.223499
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 666/666 [04:13<00:00,  2.63it/s]
path: bart_snapshot/original/openstack/epoch_2_step_666.pt
 15%|██████████████████████████████████▏                                                                                                                                                                                                   | 99/666 [00:37<03:34,  2.65it/s]Epoch 3 / 3  the step 100-- Total loss: 29.808998
 30%|████████████████████████████████████████████████████████████████████▍                                                                                                                                                                | 199/666 [01:15<02:56,  2.65it/s]Epoch 3 / 3  the step 200-- Total loss: 26.594603
 45%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                              | 299/666 [01:53<02:18,  2.66it/s]Epoch 3 / 3  the step 300-- Total loss: 24.484814
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                           | 399/666 [02:31<01:41,  2.62it/s]Epoch 3 / 3  the step 400-- Total loss: 21.550634
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 499/666 [03:09<01:02,  2.67it/s]Epoch 3 / 3  the step 500-- Total loss: 20.467649
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 599/666 [03:46<00:25,  2.62it/s]Epoch 3 / 3  the step 600-- Total loss: 17.410753
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 666/666 [04:12<00:00,  2.64it/s]
path: bart_snapshot/original/openstack/epoch_3_step_666.pt
final loss :  [66.9562759399414, 60.648868560791016, 56.96030044555664, 54.05577087402344, 56.34626007080078, 53.13997268676758, 49.55714797973633, 45.53884506225586, 43.7406120300293, 42.261253356933594, 37.795413970947266, 37.2234992980957, 29.808998107910156, 26.594602584838867, 24.484813690185547, 21.550634384155273, 20.467649459838867, 17.41075325012207]
==================================================
Some weights of the model checkpoint at plbart were not used when initializing PLBartModel: ['final_logits_bias', 'lm_head.weight']
- This IS expected if you are initializing PLBartModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing PLBartModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
torch.Size([1, 8, 768])
train plbart-base model
CUDA_VISIBLE_DEVICES=2 python bart.py -train -train_data ../data/qt_data/qt_train.pkl -save-dir plbart_snapshot/original/qt -dictionary_data ../data/qt_dict.pkl
20563 20563
 max length at tokenizer: 256
 max length for code tokenizer: 128
20563 20563 20563
pad_msg_input_ids (20563, 256)
pad_msg_input_masks (20563, 256)
pad_code_input_ids (20563, 4, 128)
pad_code_input_masks (20563, 4, 128)
Some weights of the model checkpoint at plbart were not used when initializing PLBartModel: ['final_logits_bias', 'lm_head.weight']
- This IS expected if you are initializing PLBartModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing PLBartModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
  8%|█████████████████▋                                                                                                                                                                                                                   | 99/1286 [00:38<07:27,  2.65it/s]Epoch 1 / 3  the step 100-- Total loss: 61.955257
 15%|███████████████████████████████████▎                                                                                                                                                                                                | 199/1286 [01:16<06:52,  2.63it/s]Epoch 1 / 3  the step 200-- Total loss: 55.964001
 23%|█████████████████████████████████████████████████████                                                                                                                                                                               | 299/1286 [01:55<06:16,  2.62it/s]Epoch 1 / 3  the step 300-- Total loss: 53.467686
 31%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                             | 399/1286 [02:33<05:38,  2.62it/s]Epoch 1 / 3  the step 400-- Total loss: 49.965435
 39%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                           | 499/1286 [03:11<05:01,  2.61it/s]Epoch 1 / 3  the step 500-- Total loss: 48.007996
 47%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                         | 599/1286 [03:50<04:24,  2.60it/s]Epoch 1 / 3  the step 600-- Total loss: 45.081490
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                        | 699/1286 [04:29<03:44,  2.62it/s]Epoch 1 / 3  the step 700-- Total loss: 37.272175
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 799/1286 [05:07<03:08,  2.59it/s]Epoch 1 / 3  the step 800-- Total loss: 37.292267
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 899/1286 [05:46<02:28,  2.61it/s]Epoch 1 / 3  the step 900-- Total loss: 35.213333
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 999/1286 [06:24<01:50,  2.60it/s]Epoch 1 / 3  the step 1000-- Total loss: 27.732679
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1099/1286 [07:03<01:11,  2.60it/s]Epoch 1 / 3  the step 1100-- Total loss: 27.749184
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1199/1286 [07:42<00:33,  2.60it/s]Epoch 1 / 3  the step 1200-- Total loss: 27.883036
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1286/1286 [08:15<00:00,  2.59it/s]
path: plbart_snapshot/original/qt/epoch_1_step_1286.pt
  8%|█████████████████▋                                                                                                                                                                                                                   | 99/1286 [00:38<07:36,  2.60it/s]Epoch 2 / 3  the step 100-- Total loss: 19.440832
 15%|███████████████████████████████████▎                                                                                                                                                                                                | 199/1286 [01:16<06:56,  2.61it/s]Epoch 2 / 3  the step 200-- Total loss: 15.832066
 23%|█████████████████████████████████████████████████████                                                                                                                                                                               | 299/1286 [01:55<06:19,  2.60it/s]Epoch 2 / 3  the step 300-- Total loss: 15.235427
 31%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                             | 399/1286 [02:33<05:40,  2.60it/s]Epoch 2 / 3  the step 400-- Total loss: 13.904546
 39%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                           | 499/1286 [03:12<05:02,  2.61it/s]Epoch 2 / 3  the step 500-- Total loss: 14.222768
 47%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                         | 599/1286 [03:51<04:24,  2.60it/s]Epoch 2 / 3  the step 600-- Total loss: 10.766923
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                        | 699/1286 [04:29<03:46,  2.59it/s]Epoch 2 / 3  the step 700-- Total loss: 8.752038
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 799/1286 [05:08<03:07,  2.59it/s]Epoch 2 / 3  the step 800-- Total loss: 7.702615
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 899/1286 [05:47<02:28,  2.61it/s]Epoch 2 / 3  the step 900-- Total loss: 7.907496
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 999/1286 [06:26<01:50,  2.60it/s]Epoch 2 / 3  the step 1000-- Total loss: 6.824928
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1099/1286 [07:04<01:11,  2.60it/s]Epoch 2 / 3  the step 1100-- Total loss: 7.145850
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1199/1286 [07:43<00:33,  2.59it/s]Epoch 2 / 3  the step 1200-- Total loss: 7.647476
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1286/1286 [08:17<00:00,  2.59it/s]
path: plbart_snapshot/original/qt/epoch_2_step_1286.pt
  8%|█████████████████▋                                                                                                                                                                                                                   | 99/1286 [00:38<07:35,  2.61it/s]Epoch 3 / 3  the step 100-- Total loss: 4.077142
 15%|███████████████████████████████████▎                                                                                                                                                                                                | 199/1286 [01:16<06:57,  2.60it/s]Epoch 3 / 3  the step 200-- Total loss: 6.167079
 23%|█████████████████████████████████████████████████████                                                                                                                                                                               | 299/1286 [01:55<06:18,  2.61it/s]Epoch 3 / 3  the step 300-- Total loss: 5.432592
 31%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                             | 399/1286 [02:34<05:45,  2.57it/s]Epoch 3 / 3  the step 400-- Total loss: 6.795220
 39%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                           | 499/1286 [03:12<05:03,  2.60it/s]Epoch 3 / 3  the step 500-- Total loss: 3.169895
 47%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                         | 599/1286 [03:51<04:24,  2.60it/s]Epoch 3 / 3  the step 600-- Total loss: 4.188879
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                        | 699/1286 [04:30<03:47,  2.58it/s]Epoch 3 / 3  the step 700-- Total loss: 4.710188
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 799/1286 [05:09<03:08,  2.59it/s]Epoch 3 / 3  the step 800-- Total loss: 5.864100
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 899/1286 [05:47<02:30,  2.58it/s]Epoch 3 / 3  the step 900-- Total loss: 3.587039
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 999/1286 [06:26<01:50,  2.60it/s]Epoch 3 / 3  the step 1000-- Total loss: 3.914149
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1099/1286 [07:05<01:12,  2.57it/s]Epoch 3 / 3  the step 1100-- Total loss: 2.617631
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1199/1286 [07:44<00:33,  2.60it/s]Epoch 3 / 3  the step 1200-- Total loss: 4.084904
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1286/1286 [08:17<00:00,  2.58it/s]
path: plbart_snapshot/original/qt/epoch_3_step_1286.pt
final loss :  [61.955257415771484, 55.9640007019043, 53.46768569946289, 49.96543502807617, 48.00799560546875, 45.08148956298828, 37.27217483520508, 37.292266845703125, 35.21333312988281, 27.73267936706543, 27.749183654785156, 27.88303565979004, 19.440832138061523, 15.83206558227539, 15.235426902770996, 13.904545783996582, 14.22276782989502, 10.766922950744629, 8.75203800201416, 7.702614784240723, 7.907496452331543, 6.824928283691406, 7.145849704742432, 7.647475719451904, 4.077141761779785, 6.167078971862793, 5.432591915130615, 6.795220375061035, 3.1698954105377197, 4.188878536224365, 4.710188388824463, 5.864099979400635, 3.58703875541687, 3.914149045944214, 2.617630958557129, 4.084904193878174]
train plbart-base model====================
train plbart-base model
CUDA_VISIBLE_DEVICES=2 python bart.py -train -train_data ../data/openstack_data/openstack_train.pkl -save-dir plbart_snapshot/original/openstack -dictionary_data ../data/openstack_dict.pkl
10643 10643
 max length at tokenizer: 256
 max length for code tokenizer: 128
10643 10643 10643
pad_msg_input_ids (10643, 256)
pad_msg_input_masks (10643, 256)
pad_code_input_ids (10643, 4, 128)
pad_code_input_masks (10643, 4, 128)
Some weights of the model checkpoint at plbart were not used when initializing PLBartModel: ['lm_head.weight', 'final_logits_bias']
- This IS expected if you are initializing PLBartModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing PLBartModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
 15%|██████████████████████████████████▏                                                                                                                                                                                                   | 99/666 [00:38<03:29,  2.70it/s]Epoch 1 / 3  the step 100-- Total loss: 63.693939
 30%|████████████████████████████████████████████████████████████████████▍                                                                                                                                                                | 199/666 [01:16<02:54,  2.67it/s]Epoch 1 / 3  the step 200-- Total loss: 57.242176
 45%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                              | 299/666 [01:53<02:17,  2.66it/s]Epoch 1 / 3  the step 300-- Total loss: 55.311951
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                           | 399/666 [02:31<01:41,  2.64it/s]Epoch 1 / 3  the step 400-- Total loss: 50.675205
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 499/666 [03:09<01:02,  2.65it/s]Epoch 1 / 3  the step 500-- Total loss: 46.794270
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 599/666 [03:47<00:25,  2.67it/s]Epoch 1 / 3  the step 600-- Total loss: 44.171844
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 666/666 [04:12<00:00,  2.64it/s]
path: plbart_snapshot/original/openstack/epoch_1_step_666.pt
 15%|██████████████████████████████████▏                                                                                                                                                                                                   | 99/666 [00:38<03:34,  2.64it/s]Epoch 2 / 3  the step 100-- Total loss: 34.321720
 30%|████████████████████████████████████████████████████████████████████▍                                                                                                                                                                | 199/666 [01:16<02:54,  2.68it/s]Epoch 2 / 3  the step 200-- Total loss: 27.905333
 45%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                              | 299/666 [01:54<02:19,  2.63it/s]Epoch 2 / 3  the step 300-- Total loss: 25.410414
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                           | 399/666 [02:32<01:41,  2.63it/s]Epoch 2 / 3  the step 400-- Total loss: 19.961857
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 499/666 [03:10<01:04,  2.58it/s]Epoch 2 / 3  the step 500-- Total loss: 18.633255
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 599/666 [03:48<00:25,  2.66it/s]Epoch 2 / 3  the step 600-- Total loss: 13.531380
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 666/666 [04:14<00:00,  2.61it/s]
path: plbart_snapshot/original/openstack/epoch_2_step_666.pt
 15%|██████████████████████████████████▏                                                                                                                                                                                                   | 99/666 [00:46<03:51,  2.45it/s]Epoch 3 / 3  the step 100-- Total loss: 12.332676
 30%|████████████████████████████████████████████████████████████████████▍                                                                                                                                                                | 199/666 [01:29<03:33,  2.19it/s]Epoch 3 / 3  the step 200-- Total loss: 9.913183
 45%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                              | 299/666 [02:13<02:38,  2.31it/s]Epoch 3 / 3  the step 300-- Total loss: 9.444642
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                           | 399/666 [02:58<02:01,  2.20it/s]Epoch 3 / 3  the step 400-- Total loss: 9.056283
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 499/666 [03:43<01:19,  2.11it/s]Epoch 3 / 3  the step 500-- Total loss: 8.347578
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 599/666 [04:30<00:29,  2.27it/s]Epoch 3 / 3  the step 600-- Total loss: 7.448756
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 666/666 [05:02<00:00,  2.20it/s]
path: plbart_snapshot/original/openstack/epoch_3_step_666.pt
final loss :  [63.693939208984375, 57.2421760559082, 55.31195068359375, 50.67520523071289, 46.79426956176758, 44.171844482421875, 34.321720123291016, 27.905332565307617, 25.41041374206543, 19.961856842041016, 18.633255004882812, 13.531379699707031, 12.33267593383789, 9.913183212280273, 9.444642066955566, 9.056282997131348, 8.347578048706055, 7.448755741119385]
==============================================
CUDA_VISIBLE_DEVICES=0 python GPT2.py -train -train_data ../data/qt_data/qt_train.pkl -save-dir gpt2_snapshot/original/qt -dictionary_data ../data/qt_dict.pkl
20563 20563
 max length at tokenizer: 256
 max length for code tokenizer: 120
20563 20563 20563
pad_msg_input_ids (20563, 256)
pad_msg_input_masks (20563, 256)
pad_code_input_ids (20563, 4, 120)
pad_code_input_masks (20563, 4, 120)
  8%|█████████████████▋                                                                                                                                                                                                                   | 99/1286 [00:57<11:04,  1.79it/s]Epoch 1 / 3  the step 100-- Total loss: 71.965149
 15%|███████████████████████████████████▎                                                                                                                                                                                                | 199/1286 [01:53<10:13,  1.77it/s]Epoch 1 / 3  the step 200-- Total loss: 66.187737
 23%|█████████████████████████████████████████████████████                                                                                                                                                                               | 299/1286 [02:50<09:17,  1.77it/s]Epoch 1 / 3  the step 300-- Total loss: 61.190796
 31%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                             | 399/1286 [03:46<08:22,  1.76it/s]Epoch 1 / 3  the step 400-- Total loss: 58.449162
 39%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                           | 499/1286 [04:43<07:24,  1.77it/s]Epoch 1 / 3  the step 500-- Total loss: 56.795536
 47%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                         | 599/1286 [05:40<06:28,  1.77it/s]Epoch 1 / 3  the step 600-- Total loss: 52.579964
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                        | 699/1286 [06:36<05:32,  1.77it/s]Epoch 1 / 3  the step 700-- Total loss: 52.506203
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 799/1286 [07:33<04:35,  1.77it/s]Epoch 1 / 3  the step 800-- Total loss: 50.272800
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 899/1286 [08:30<03:39,  1.76it/s]Epoch 1 / 3  the step 900-- Total loss: 46.910767
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 999/1286 [09:26<02:40,  1.79it/s]Epoch 1 / 3  the step 1000-- Total loss: 45.925442
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1099/1286 [10:23<01:44,  1.79it/s]Epoch 1 / 3  the step 1100-- Total loss: 42.645931
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1199/1286 [11:19<00:49,  1.77it/s]Epoch 1 / 3  the step 1200-- Total loss: 42.981091
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1286/1286 [12:08<00:00,  1.76it/s]
path: gpt2_snapshot/original/qt/epoch_1_step_1286.pt
  8%|█████████████████▋                                                                                                                                                                                                                   | 99/1286 [00:55<11:09,  1.77it/s]Epoch 2 / 3  the step 100-- Total loss: 39.177383
 15%|███████████████████████████████████▎                                                                                                                                                                                                | 199/1286 [01:52<10:12,  1.78it/s]Epoch 2 / 3  the step 200-- Total loss: 31.532257
 23%|█████████████████████████████████████████████████████                                                                                                                                                                               | 299/1286 [02:49<09:19,  1.77it/s]Epoch 2 / 3  the step 300-- Total loss: 32.678928
 31%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                             | 399/1286 [03:46<08:23,  1.76it/s]Epoch 2 / 3  the step 400-- Total loss: 30.405682
 39%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                           | 499/1286 [04:43<07:27,  1.76it/s]Epoch 2 / 3  the step 500-- Total loss: 28.416409
 47%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                         | 599/1286 [05:39<06:27,  1.77it/s]Epoch 2 / 3  the step 600-- Total loss: 22.837101
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                        | 699/1286 [06:36<05:31,  1.77it/s]Epoch 2 / 3  the step 700-- Total loss: 19.568136
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 799/1286 [07:33<04:34,  1.77it/s]Epoch 2 / 3  the step 800-- Total loss: 20.156223
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 899/1286 [08:29<03:38,  1.77it/s]Epoch 2 / 3  the step 900-- Total loss: 18.474796
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 999/1286 [09:26<02:40,  1.78it/s]Epoch 2 / 3  the step 1000-- Total loss: 17.187494
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1099/1286 [10:23<01:44,  1.78it/s]Epoch 2 / 3  the step 1100-- Total loss: 12.072646
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1199/1286 [11:19<00:49,  1.77it/s]Epoch 2 / 3  the step 1200-- Total loss: 14.260314
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1286/1286 [12:09<00:00,  1.76it/s]
path: gpt2_snapshot/original/qt/epoch_2_step_1286.pt
  8%|█████████████████▋                                                                                                                                                                                                                   | 99/1286 [00:55<10:57,  1.81it/s]Epoch 3 / 3  the step 100-- Total loss: 12.648346
 15%|███████████████████████████████████▎                                                                                                                                                                                                | 199/1286 [01:51<10:15,  1.77it/s]Epoch 3 / 3  the step 200-- Total loss: 9.609231
 23%|█████████████████████████████████████████████████████                                                                                                                                                                               | 299/1286 [02:48<09:18,  1.77it/s]Epoch 3 / 3  the step 300-- Total loss: 10.292735
 31%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                             | 399/1286 [03:45<08:22,  1.77it/s]Epoch 3 / 3  the step 400-- Total loss: 8.294368
 39%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                           | 499/1286 [04:42<07:25,  1.77it/s]Epoch 3 / 3  the step 500-- Total loss: 10.380846
 47%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                         | 599/1286 [05:38<06:30,  1.76it/s]Epoch 3 / 3  the step 600-- Total loss: 5.863049
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                        | 699/1286 [06:35<05:32,  1.77it/s]Epoch 3 / 3  the step 700-- Total loss: 7.231608
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 799/1286 [07:32<04:35,  1.77it/s]Epoch 3 / 3  the step 800-- Total loss: 7.584276
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 899/1286 [08:28<03:34,  1.81it/s]Epoch 3 / 3  the step 900-- Total loss: 5.957664
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 999/1286 [09:25<02:43,  1.76it/s]Epoch 3 / 3  the step 1000-- Total loss: 6.330650
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1099/1286 [10:21<01:44,  1.79it/s]Epoch 3 / 3  the step 1100-- Total loss: 5.851252
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1199/1286 [11:18<00:49,  1.77it/s]Epoch 3 / 3  the step 1200-- Total loss: 5.228467
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1286/1286 [12:07<00:00,  1.77it/s]
path: gpt2_snapshot/original/qt/epoch_3_step_1286.pt
final loss :  [71.96514892578125, 66.18773651123047, 61.1907958984375, 58.449161529541016, 56.795536041259766, 52.57996368408203, 52.506202697753906, 50.27280044555664, 46.9107666015625, 45.92544174194336, 42.645931243896484, 42.9810905456543, 39.17738342285156, 31.532257080078125, 32.67892837524414, 30.405681610107422, 28.41640853881836, 22.837100982666016, 19.56813621520996, 20.15622329711914, 18.474796295166016, 17.1874942779541, 12.072646141052246, 14.260313987731934, 12.648345947265625, 9.609230995178223, 10.29273509979248, 8.294367790222168, 10.38084602355957, 5.863048553466797, 7.231607913970947, 7.58427619934082, 5.957663536071777, 6.330650329589844, 5.85125207901001, 5.2284674644470215]
CUDA_VISIBLE_DEVICES=0 python GPT2.py -train -train_data ../data/openstack_data/openstack_train.pkl -save-dir gpt2_snapshot/original/openstack -dictionary_data ../data/openstack_dict.pkl
10643 10643
 max length at tokenizer: 256
 max length for code tokenizer: 120
10643 10643 10643
pad_msg_input_ids (10643, 256)
pad_msg_input_masks (10643, 256)
pad_code_input_ids (10643, 4, 120)
pad_code_input_masks (10643, 4, 120)
 15%|██████████████████████████████████▏                                                                                                                                                                                                   | 99/666 [00:56<05:19,  1.77it/s]Epoch 1 / 3  the step 100-- Total loss: 74.263908
 30%|████████████████████████████████████████████████████████████████████▍                                                                                                                                                                | 199/666 [01:53<04:22,  1.78it/s]Epoch 1 / 3  the step 200-- Total loss: 69.264076
 45%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                              | 299/666 [02:50<03:25,  1.78it/s]Epoch 1 / 3  the step 300-- Total loss: 65.823730
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                           | 399/666 [03:46<02:31,  1.77it/s]Epoch 1 / 3  the step 400-- Total loss: 62.964741
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 499/666 [04:42<01:34,  1.77it/s]Epoch 1 / 3  the step 500-- Total loss: 59.219349
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 599/666 [05:40<00:37,  1.77it/s]Epoch 1 / 3  the step 600-- Total loss: 59.667973
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 666/666 [06:18<00:00,  1.76it/s]
path: gpt2_snapshot/original/openstack/epoch_1_step_666.pt
 15%|██████████████████████████████████▏                                                                                                                                                                                                   | 99/666 [00:55<05:21,  1.77it/s]Epoch 2 / 3  the step 100-- Total loss: 54.952065
 30%|████████████████████████████████████████████████████████████████████▍                                                                                                                                                                | 199/666 [01:52<04:24,  1.77it/s]Epoch 2 / 3  the step 200-- Total loss: 52.418541
 45%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                              | 299/666 [02:49<03:28,  1.76it/s]Epoch 2 / 3  the step 300-- Total loss: 52.301926
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                           | 399/666 [03:46<02:30,  1.77it/s]Epoch 2 / 3  the step 400-- Total loss: 51.597385
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 499/666 [04:42<01:32,  1.80it/s]Epoch 2 / 3  the step 500-- Total loss: 48.659286
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 599/666 [05:39<00:37,  1.77it/s]Epoch 2 / 3  the step 600-- Total loss: 46.668297
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 666/666 [06:17<00:00,  1.77it/s]
path: gpt2_snapshot/original/openstack/epoch_2_step_666.pt
 15%|██████████████████████████████████▏                                                                                                                                                                                                   | 99/666 [00:56<05:19,  1.77it/s]Epoch 3 / 3  the step 100-- Total loss: 43.230347
 30%|████████████████████████████████████████████████████████████████████▍                                                                                                                                                                | 199/666 [01:52<04:22,  1.78it/s]Epoch 3 / 3  the step 200-- Total loss: 39.410061
 45%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                              | 299/666 [02:49<03:28,  1.76it/s]Epoch 3 / 3  the step 300-- Total loss: 38.653034
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                           | 399/666 [03:46<02:31,  1.76it/s]Epoch 3 / 3  the step 400-- Total loss: 33.177452
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 499/666 [04:43<01:34,  1.77it/s]Epoch 3 / 3  the step 500-- Total loss: 33.002373
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 599/666 [05:39<00:37,  1.77it/s]Epoch 3 / 3  the step 600-- Total loss: 28.088737
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 666/666 [06:17<00:00,  1.76it/s]
path: gpt2_snapshot/original/openstack/epoch_3_step_666.pt
final loss :  [74.26390838623047, 69.26407623291016, 65.82373046875, 62.96474075317383, 59.2193489074707, 59.667972564697266, 54.952064514160156, 52.418540954589844, 52.30192565917969, 51.59738540649414, 48.65928649902344, 46.668296813964844, 43.2303466796875, 39.41006088256836, 38.65303421020508, 33.177452087402344, 33.00237274169922, 28.08873748779297]
==========================================================
train codegpt model====================
CUDA_VISIBLE_DEVICES=0 python CodeGPT.py -train -train_data ../data/qt_data/qt_train.pkl -save-dir codegpt_snapshot/original/qt -dictionary_data ../data/qt_dict.pkl -dictionary_data ../data/qt_dict.pkl
20563 20563
Downloading: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 153/153 [00:00<00:00, 64.5kB/s]
Downloading: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 610/610 [00:00<00:00, 185kB/s]
Downloading: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 959k/959k [00:00<00:00, 1.38MB/s]
Downloading: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 518k/518k [00:00<00:00, 889kB/s]
Downloading: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 358/358 [00:00<00:00, 138kB/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
 max length at tokenizer: 256
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
 max length for code tokenizer: 120
20563 20563 20563
pad_msg_input_ids (20563, 256)
pad_msg_input_masks (20563, 256)
pad_code_input_ids (20563, 4, 120)
pad_code_input_masks (20563, 4, 120)
Downloading: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 516M/516M [00:29<00:00, 17.4MB/s]
Some weights of the model checkpoint at microsoft/CodeGPT-small-java were not used when initializing GPT2Model: ['lm_head.weight']
- This IS expected if you are initializing GPT2Model from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing GPT2Model from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
  8%|█████████████████▋                                                                                                                                                                                                                   | 99/1286 [00:55<10:51,  1.82it/s]Epoch 1 / 3  the step 100-- Total loss: 64.914978
 15%|███████████████████████████████████▎                                                                                                                                                                                                | 199/1286 [01:50<10:02,  1.80it/s]Epoch 1 / 3  the step 200-- Total loss: 57.467754
 23%|█████████████████████████████████████████████████████                                                                                                                                                                               | 299/1286 [02:46<09:09,  1.80it/s]Epoch 1 / 3  the step 300-- Total loss: 54.601910
 31%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                             | 399/1286 [03:41<08:11,  1.81it/s]Epoch 1 / 3  the step 400-- Total loss: 51.418144
 39%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                           | 499/1286 [04:37<07:17,  1.80it/s]Epoch 1 / 3  the step 500-- Total loss: 47.089008
 47%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                         | 599/1286 [05:33<06:21,  1.80it/s]Epoch 1 / 3  the step 600-- Total loss: 43.983669
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                        | 699/1286 [06:29<05:26,  1.80it/s]Epoch 1 / 3  the step 700-- Total loss: 41.145290
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 799/1286 [07:24<04:28,  1.82it/s]Epoch 1 / 3  the step 800-- Total loss: 36.205982
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 899/1286 [08:21<03:35,  1.80it/s]Epoch 1 / 3  the step 900-- Total loss: 34.962688
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 999/1286 [09:17<02:39,  1.80it/s]Epoch 1 / 3  the step 1000-- Total loss: 32.050198
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1099/1286 [10:12<01:44,  1.80it/s]Epoch 1 / 3  the step 1100-- Total loss: 29.161221
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1199/1286 [11:08<00:48,  1.79it/s]Epoch 1 / 3  the step 1200-- Total loss: 28.413479
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1286/1286 [11:57<00:00,  1.79it/s]
path: codegpt_snapshot/original/qt/epoch_1_step_1286.pt
  8%|█████████████████▋                                                                                                                                                                                                                   | 99/1286 [00:54<11:01,  1.79it/s]Epoch 2 / 3  the step 100-- Total loss: 18.797749
 15%|███████████████████████████████████▎                                                                                                                                                                                                | 199/1286 [01:50<10:03,  1.80it/s]Epoch 2 / 3  the step 200-- Total loss: 18.462933
 23%|█████████████████████████████████████████████████████                                                                                                                                                                               | 299/1286 [02:46<09:10,  1.79it/s]Epoch 2 / 3  the step 300-- Total loss: 16.171270
 31%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                             | 399/1286 [03:42<08:13,  1.80it/s]Epoch 2 / 3  the step 400-- Total loss: 13.555131
 39%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                           | 499/1286 [04:38<07:18,  1.79it/s]Epoch 2 / 3  the step 500-- Total loss: 11.989715
 47%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                         | 599/1286 [05:33<06:22,  1.80it/s]Epoch 2 / 3  the step 600-- Total loss: 11.761838
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                        | 699/1286 [06:29<05:26,  1.80it/s]Epoch 2 / 3  the step 700-- Total loss: 8.965023
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 799/1286 [07:25<04:31,  1.79it/s]Epoch 2 / 3  the step 800-- Total loss: 8.276938
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 899/1286 [08:21<03:35,  1.80it/s]Epoch 2 / 3  the step 900-- Total loss: 9.270925
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 999/1286 [09:16<02:39,  1.80it/s]Epoch 2 / 3  the step 1000-- Total loss: 7.759231
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1099/1286 [10:12<01:44,  1.79it/s]Epoch 2 / 3  the step 1100-- Total loss: 8.024748
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1199/1286 [11:08<00:48,  1.79it/s]Epoch 2 / 3  the step 1200-- Total loss: 8.276628
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1286/1286 [11:56<00:00,  1.79it/s]
path: codegpt_snapshot/original/qt/epoch_2_step_1286.pt
  8%|█████████████████▋                                                                                                                                                                                                                   | 99/1286 [00:54<10:59,  1.80it/s]Epoch 3 / 3  the step 100-- Total loss: 7.641795
 15%|███████████████████████████████████▎                                                                                                                                                                                                | 199/1286 [01:50<10:04,  1.80it/s]Epoch 3 / 3  the step 200-- Total loss: 4.803708
 23%|█████████████████████████████████████████████████████                                                                                                                                                                               | 299/1286 [02:46<09:09,  1.80it/s]Epoch 3 / 3  the step 300-- Total loss: 3.774014
 31%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                             | 399/1286 [03:42<08:12,  1.80it/s]Epoch 3 / 3  the step 400-- Total loss: 4.720999
 39%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                           | 499/1286 [04:37<07:18,  1.79it/s]Epoch 3 / 3  the step 500-- Total loss: 4.720934
 47%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                         | 599/1286 [05:33<06:22,  1.80it/s]Epoch 3 / 3  the step 600-- Total loss: 4.093260
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                        | 699/1286 [06:30<05:27,  1.79it/s]Epoch 3 / 3  the step 700-- Total loss: 3.236826
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 799/1286 [07:26<04:31,  1.80it/s]Epoch 3 / 3  the step 800-- Total loss: 4.690817
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 899/1286 [08:21<03:34,  1.80it/s]Epoch 3 / 3  the step 900-- Total loss: 4.869076
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 999/1286 [09:17<02:39,  1.80it/s]Epoch 3 / 3  the step 1000-- Total loss: 4.613527
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1099/1286 [10:13<01:43,  1.81it/s]Epoch 3 / 3  the step 1100-- Total loss: 4.678867
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1199/1286 [11:09<00:48,  1.80it/s]Epoch 3 / 3  the step 1200-- Total loss: 3.164419
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1286/1286 [11:57<00:00,  1.79it/s]
path: codegpt_snapshot/original/qt/epoch_3_step_1286.pt
final loss :  [64.91497802734375, 57.46775436401367, 54.60190963745117, 51.41814422607422, 47.08900833129883, 43.98366928100586, 41.14529037475586, 36.20598220825195, 34.96268844604492, 32.05019760131836, 29.16122055053711, 28.41347885131836, 18.797748565673828, 18.462932586669922, 16.1712703704834, 13.555130958557129, 11.989714622497559, 11.76183795928955, 8.965023040771484, 8.276938438415527, 9.27092456817627, 7.759230613708496, 8.024747848510742, 8.276628494262695, 7.641794681549072, 4.803707599639893, 3.7740137577056885, 4.720999240875244, 4.7209343910217285, 4.093260288238525, 3.2368264198303223, 4.690816879272461, 4.869076251983643, 4.613526821136475, 4.678867340087891, 3.164419174194336]

CUDA_VISIBLE_DEVICES=0 python CodeGPT.py -train -train_data ../data/openstack_data/openstack_train.pkl -save-dir codegpt_snapshot/original/openstack -dictionary_data ../data/openstack_dict.pkl -dictionary_data ../data/openstack_dict.pkl
10643 10643
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
 max length at tokenizer: 256
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
 max length for code tokenizer: 120
10643 10643 10643
pad_msg_input_ids (10643, 256)
pad_msg_input_masks (10643, 256)
pad_code_input_ids (10643, 4, 120)
pad_code_input_masks (10643, 4, 120)
Some weights of the model checkpoint at microsoft/CodeGPT-small-java were not used when initializing GPT2Model: ['lm_head.weight']
- This IS expected if you are initializing GPT2Model from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing GPT2Model from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
 15%|██████████████████████████████████▏                                                                                                                                                                                                   | 99/666 [00:55<05:13,  1.81it/s]Epoch 1 / 3  the step 100-- Total loss: 63.514019
 30%|████████████████████████████████████████████████████████████████████▍                                                                                                                                                                | 199/666 [01:51<04:19,  1.80it/s]Epoch 1 / 3  the step 200-- Total loss: 58.220245
 45%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                              | 299/666 [02:46<03:24,  1.79it/s]Epoch 1 / 3  the step 300-- Total loss: 58.096233
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                           | 399/666 [03:42<02:28,  1.80it/s]Epoch 1 / 3  the step 400-- Total loss: 54.187122
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 499/666 [04:38<01:33,  1.79it/s]Epoch 1 / 3  the step 500-- Total loss: 52.290882
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 599/666 [05:34<00:36,  1.82it/s]Epoch 1 / 3  the step 600-- Total loss: 48.552212
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 666/666 [06:11<00:00,  1.79it/s]
path: codegpt_snapshot/original/openstack/epoch_1_step_666.pt
 15%|██████████████████████████████████▏                                                                                                                                                                                                   | 99/666 [00:55<05:15,  1.80it/s]Epoch 2 / 3  the step 100-- Total loss: 42.122730
 30%|████████████████████████████████████████████████████████████████████▍                                                                                                                                                                | 199/666 [01:50<04:17,  1.81it/s]Epoch 2 / 3  the step 200-- Total loss: 35.314121
 45%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                              | 299/666 [02:46<03:24,  1.80it/s]Epoch 2 / 3  the step 300-- Total loss: 32.293499
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                           | 399/666 [03:42<02:28,  1.79it/s]Epoch 2 / 3  the step 400-- Total loss: 28.257166
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 499/666 [04:38<01:33,  1.80it/s]Epoch 2 / 3  the step 500-- Total loss: 22.390734
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 599/666 [05:34<00:37,  1.80it/s]Epoch 2 / 3  the step 600-- Total loss: 17.704525
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 666/666 [06:11<00:00,  1.79it/s]
path: codegpt_snapshot/original/openstack/epoch_2_step_666.pt
 15%|██████████████████████████████████▏                                                                                                                                                                                                   | 99/666 [00:55<05:16,  1.79it/s]Epoch 3 / 3  the step 100-- Total loss: 11.460841
 30%|████████████████████████████████████████████████████████████████████▍                                                                                                                                                                | 199/666 [01:50<04:19,  1.80it/s]Epoch 3 / 3  the step 200-- Total loss: 11.616483
 45%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                              | 299/666 [02:46<03:24,  1.80it/s]Epoch 3 / 3  the step 300-- Total loss: 9.164912
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                           | 399/666 [03:42<02:28,  1.80it/s]Epoch 3 / 3  the step 400-- Total loss: 8.180253
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 499/666 [04:38<01:32,  1.81it/s]Epoch 3 / 3  the step 500-- Total loss: 6.715749
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 599/666 [05:34<00:37,  1.79it/s]Epoch 3 / 3  the step 600-- Total loss: 5.796124
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 666/666 [06:12<00:00,  1.79it/s]
path: codegpt_snapshot/original/openstack/epoch_3_step_666.pt
final loss :  [63.51401901245117, 58.220245361328125, 58.09623336791992, 54.1871223449707, 52.2908821105957, 48.55221176147461, 42.12273025512695, 35.31412124633789, 32.29349899291992, 28.257165908813477, 22.39073371887207, 17.704524993896484, 11.460841178894043, 11.616482734680176, 9.164912223815918, 8.180253028869629, 6.7157487869262695, 5.79612398147583]

==========================================
train roberta model====================
train roberta-base model
CUDA_VISIBLE_DEVICES=0 python RoBERTa.py -train -train_data ../data/qt_data/qt_train.pkl -save-dir roberta_snapshot/original/qt -dictionary_data ../data/qt_dict.pkl
20563 20563
 max length at tokenizer: 256
 max length for code tokenizer: 128
20563 20563 20563
pad_msg_input_ids (20563, 256)
pad_msg_input_masks (20563, 256)
pad_code_input_ids (20563, 4, 128)
pad_code_input_masks (20563, 4, 128)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaModel: ['lm_head.decoder.weight', 'lm_head.dense.weight', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.bias', 'lm_head.dense.bias']
- This IS expected if you are initializing RobertaModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
  8%|█████████████████▋                                                                                                                                                                                                                   | 99/1286 [00:50<09:50,  2.01it/s]Epoch 1 / 3  the step 100-- Total loss: 65.051926
 15%|███████████████████████████████████▎                                                                                                                                                                                                | 199/1286 [01:40<09:05,  1.99it/s]Epoch 1 / 3  the step 200-- Total loss: 56.255714
 23%|█████████████████████████████████████████████████████                                                                                                                                                                               | 299/1286 [02:30<08:14,  1.99it/s]Epoch 1 / 3  the step 300-- Total loss: 52.015640
 31%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                             | 399/1286 [03:20<07:24,  1.99it/s]Epoch 1 / 3  the step 400-- Total loss: 52.611183
 39%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                           | 499/1286 [04:11<06:29,  2.02it/s]Epoch 1 / 3  the step 500-- Total loss: 49.643547
 47%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                         | 599/1286 [05:01<05:44,  2.00it/s]Epoch 1 / 3  the step 600-- Total loss: 44.613621
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                        | 699/1286 [05:51<04:55,  1.99it/s]Epoch 1 / 3  the step 700-- Total loss: 40.361481
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 799/1286 [06:42<04:04,  1.99it/s]Epoch 1 / 3  the step 800-- Total loss: 40.098991
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 899/1286 [07:31<03:13,  2.00it/s]Epoch 1 / 3  the step 900-- Total loss: 32.697075
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 999/1286 [08:22<02:23,  1.99it/s]Epoch 1 / 3  the step 1000-- Total loss: 30.510988
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1099/1286 [09:12<01:33,  2.00it/s]Epoch 1 / 3  the step 1100-- Total loss: 30.464497
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1199/1286 [10:02<00:43,  2.01it/s]Epoch 1 / 3  the step 1200-- Total loss: 26.516586
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1286/1286 [10:46<00:00,  1.99it/s]
path: roberta_snapshot/original/qt/epoch_1_step_1286.pt
  8%|█████████████████▋                                                                                                                                                                                                                   | 99/1286 [00:49<09:59,  1.98it/s]Epoch 2 / 3  the step 100-- Total loss: 23.921614
 15%|███████████████████████████████████▎                                                                                                                                                                                                | 199/1286 [01:39<09:03,  2.00it/s]Epoch 2 / 3  the step 200-- Total loss: 19.679264
 23%|█████████████████████████████████████████████████████                                                                                                                                                                               | 299/1286 [02:30<08:17,  1.98it/s]Epoch 2 / 3  the step 300-- Total loss: 16.679869
 31%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                             | 399/1286 [03:20<07:26,  1.99it/s]Epoch 2 / 3  the step 400-- Total loss: 15.731032
 39%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                           | 499/1286 [04:10<06:27,  2.03it/s]Epoch 2 / 3  the step 500-- Total loss: 14.838801
 47%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                         | 599/1286 [05:00<05:45,  1.99it/s]Epoch 2 / 3  the step 600-- Total loss: 12.553340
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                        | 699/1286 [05:51<04:54,  1.99it/s]Epoch 2 / 3  the step 700-- Total loss: 12.150622
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 799/1286 [06:41<04:03,  2.00it/s]Epoch 2 / 3  the step 800-- Total loss: 9.481293
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 899/1286 [07:31<03:14,  1.99it/s]Epoch 2 / 3  the step 900-- Total loss: 8.496828
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 999/1286 [08:22<02:24,  1.99it/s]Epoch 2 / 3  the step 1000-- Total loss: 8.457484
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1099/1286 [09:12<01:34,  1.98it/s]Epoch 2 / 3  the step 1100-- Total loss: 8.954422
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1199/1286 [10:02<00:43,  1.99it/s]Epoch 2 / 3  the step 1200-- Total loss: 9.816667
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1286/1286 [10:46<00:00,  1.99it/s]
path: roberta_snapshot/original/qt/epoch_2_step_1286.pt
  8%|█████████████████▋                                                                                                                                                                                                                   | 99/1286 [00:49<09:48,  2.02it/s]Epoch 3 / 3  the step 100-- Total loss: 7.752836
 15%|███████████████████████████████████▎                                                                                                                                                                                                | 199/1286 [01:39<08:52,  2.04it/s]Epoch 3 / 3  the step 200-- Total loss: 6.224505
 23%|█████████████████████████████████████████████████████                                                                                                                                                                               | 299/1286 [02:29<08:10,  2.01it/s]Epoch 3 / 3  the step 300-- Total loss: 4.628785
 31%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                             | 399/1286 [03:20<07:25,  1.99it/s]Epoch 3 / 3  the step 400-- Total loss: 5.403258
 39%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                           | 499/1286 [04:10<06:31,  2.01it/s]Epoch 3 / 3  the step 500-- Total loss: 5.778549
 47%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                         | 599/1286 [05:00<05:43,  2.00it/s]Epoch 3 / 3  the step 600-- Total loss: 6.061742
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                        | 699/1286 [05:51<04:55,  1.99it/s]Epoch 3 / 3  the step 700-- Total loss: 5.284315
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 799/1286 [06:41<04:00,  2.02it/s]Epoch 3 / 3  the step 800-- Total loss: 4.441360
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 899/1286 [07:31<03:13,  2.00it/s]Epoch 3 / 3  the step 900-- Total loss: 3.833540
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 999/1286 [08:22<02:23,  2.00it/s]Epoch 3 / 3  the step 1000-- Total loss: 1.326462
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1099/1286 [09:12<01:32,  2.02it/s]Epoch 3 / 3  the step 1100-- Total loss: 5.423771
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1199/1286 [10:02<00:43,  1.98it/s]Epoch 3 / 3  the step 1200-- Total loss: 4.995100
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1286/1286 [10:46<00:00,  1.99it/s]
path: roberta_snapshot/original/qt/epoch_3_step_1286.pt
final loss :  [65.05192565917969, 56.255714416503906, 52.01564025878906, 52.611183166503906, 49.64354705810547, 44.61362075805664, 40.361480712890625, 40.09899139404297, 32.69707489013672, 30.510988235473633, 30.464496612548828, 26.516586303710938, 23.921613693237305, 19.679264068603516, 16.679868698120117, 15.731032371520996, 14.838801383972168, 12.553339958190918, 12.150622367858887, 9.481292724609375, 8.496828079223633, 8.457484245300293, 8.954421997070312, 9.816666603088379, 7.752835750579834, 6.2245049476623535, 4.628784656524658, 5.403257846832275, 5.7785491943359375, 6.061742305755615, 5.28431510925293, 4.441359996795654, 3.8335397243499756, 1.3264620304107666, 5.423771381378174, 4.995100021362305]
Traceback (most recent call last):
  File "RoBERTa.py", line 673, in <module>
    train_model(data=data, params=params)
  File "RoBERTa.py", line 453, in train_model
    write_csv(params.save_loss_path,file_name='loss.csv', data=loss_res)
AttributeError: 'Namespace' object has no attribute 'save_loss_path'
CUDA_VISIBLE_DEVICES=0 python RoBERTa.py -train -train_data ../data/openstack_data/openstack_train.pkl -save-dir roberta_snapshot/original/openstack -dictionary_data ../data/openstack_dict.pkl
10643 10643
 max length at tokenizer: 256
 max length for code tokenizer: 128
10643 10643 10643
pad_msg_input_ids (10643, 256)
pad_msg_input_masks (10643, 256)
pad_code_input_ids (10643, 4, 128)
pad_code_input_masks (10643, 4, 128)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaModel: ['lm_head.layer_norm.bias', 'lm_head.decoder.weight', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.bias', 'lm_head.layer_norm.weight']
- This IS expected if you are initializing RobertaModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
 15%|██████████████████████████████████▏                                                                                                                                                                                                   | 99/666 [00:50<04:42,  2.00it/s]Epoch 1 / 3  the step 100-- Total loss: 66.003929
 30%|████████████████████████████████████████████████████████████████████▍                                                                                                                                                                | 199/666 [01:40<03:54,  1.99it/s]Epoch 1 / 3  the step 200-- Total loss: 57.977020
 45%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                              | 299/666 [02:30<03:04,  1.99it/s]Epoch 1 / 3  the step 300-- Total loss: 55.032158
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                           | 399/666 [03:21<02:14,  1.98it/s]Epoch 1 / 3  the step 400-- Total loss: 50.098850
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 499/666 [04:11<01:23,  1.99it/s]Epoch 1 / 3  the step 500-- Total loss: 50.488373
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 599/666 [05:01<00:32,  2.04it/s]Epoch 1 / 3  the step 600-- Total loss: 43.689144
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 666/666 [05:35<00:00,  1.98it/s]
path: roberta_snapshot/original/openstack/epoch_1_step_666.pt
 15%|██████████████████████████████████▏                                                                                                                                                                                                   | 99/666 [00:49<04:44,  1.99it/s]Epoch 2 / 3  the step 100-- Total loss: 37.721226
 30%|████████████████████████████████████████████████████████████████████▍                                                                                                                                                                | 199/666 [01:40<03:56,  1.98it/s]Epoch 2 / 3  the step 200-- Total loss: 34.227612
 45%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                              | 299/666 [02:30<03:04,  1.99it/s]Epoch 2 / 3  the step 300-- Total loss: 30.634335
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                           | 399/666 [03:21<02:13,  2.00it/s]Epoch 2 / 3  the step 400-- Total loss: 30.143652
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 499/666 [04:11<01:23,  1.99it/s]Epoch 2 / 3  the step 500-- Total loss: 23.539511
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 599/666 [05:02<00:33,  1.98it/s]Epoch 2 / 3  the step 600-- Total loss: 22.565813
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 666/666 [05:35<00:00,  1.98it/s]
path: roberta_snapshot/original/openstack/epoch_2_step_666.pt
 15%|██████████████████████████████████▏                                                                                                                                                                                                   | 99/666 [00:49<04:45,  1.99it/s]Epoch 3 / 3  the step 100-- Total loss: 17.165821
 30%|████████████████████████████████████████████████████████████████████▍                                                                                                                                                                | 199/666 [01:39<03:49,  2.03it/s]Epoch 3 / 3  the step 200-- Total loss: 17.359669
 45%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                              | 299/666 [02:29<03:04,  1.99it/s]Epoch 3 / 3  the step 300-- Total loss: 18.005924
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                           | 399/666 [03:20<02:14,  1.99it/s]Epoch 3 / 3  the step 400-- Total loss: 10.557984
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 499/666 [04:10<01:24,  1.98it/s]Epoch 3 / 3  the step 500-- Total loss: 11.923473
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 599/666 [05:01<00:33,  1.99it/s]Epoch 3 / 3  the step 600-- Total loss: 9.542233
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 666/666 [05:35<00:00,  1.99it/s]
path: roberta_snapshot/original/openstack/epoch_3_step_666.pt
final loss :  [66.0039291381836, 57.977020263671875, 55.03215789794922, 50.09885025024414, 50.488372802734375, 43.689144134521484, 37.72122573852539, 34.22761154174805, 30.634334564208984, 30.143651962280273, 23.53951072692871, 22.565813064575195, 17.165821075439453, 17.359668731689453, 18.005924224853516, 10.557984352111816, 11.923473358154297, 9.542232513427734]
Traceback (most recent call last):
  File "RoBERTa.py", line 673, in <module>
    train_model(data=data, params=params)
  File "RoBERTa.py", line 453, in train_model
    write_csv(params.save_loss_path,file_name='loss.csv', data=loss_res)
AttributeError: 'Namespace' object has no attribute 'save_loss_path'
train codebert model====================
train plbart-base model
CUDA_VISIBLE_DEVICES=0 python CodeBERT.py -train -train_data ../data/qt_data/qt_train.pkl -save-dir codebert_snapshot/original/qt -dictionary_data ../data/qt_dict.pkl -dictionary_data ../data/qt_dict.pkl
20563 20563
 max length at tokenizer: 256
 max length for code tokenizer: 128
20563 20563 20563
pad_msg_input_ids (20563, 256)
pad_msg_input_masks (20563, 256)
pad_code_input_ids (20563, 4, 128)
pad_code_input_masks (20563, 4, 128)
  8%|█████████████████▋                                                                                                                                                                                                                   | 99/1286 [00:49<09:34,  2.07it/s]Epoch 1 / 3  the step 100-- Total loss: 66.955460
 15%|███████████████████████████████████▎                                                                                                                                                                                                | 199/1286 [01:39<09:04,  1.99it/s]Epoch 1 / 3  the step 200-- Total loss: 57.392677
 23%|█████████████████████████████████████████████████████                                                                                                                                                                               | 299/1286 [02:30<08:13,  2.00it/s]Epoch 1 / 3  the step 300-- Total loss: 52.167953
 31%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                             | 399/1286 [03:20<07:22,  2.00it/s]Epoch 1 / 3  the step 400-- Total loss: 47.550583
 39%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                           | 499/1286 [04:10<06:36,  1.99it/s]Epoch 1 / 3  the step 500-- Total loss: 48.596874
 47%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                         | 599/1286 [05:01<05:46,  1.98it/s]Epoch 1 / 3  the step 600-- Total loss: 43.139118
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                        | 699/1286 [05:51<04:55,  1.99it/s]Epoch 1 / 3  the step 700-- Total loss: 39.674969
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 799/1286 [06:42<04:05,  1.98it/s]Epoch 1 / 3  the step 800-- Total loss: 37.344273
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 899/1286 [07:32<03:11,  2.02it/s]Epoch 1 / 3  the step 900-- Total loss: 34.922974
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 999/1286 [08:23<02:24,  1.98it/s]Epoch 1 / 3  the step 1000-- Total loss: 30.847563
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1099/1286 [09:12<01:34,  1.99it/s]Epoch 1 / 3  the step 1100-- Total loss: 25.578911
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1199/1286 [10:03<00:43,  1.99it/s]Epoch 1 / 3  the step 1200-- Total loss: 24.851366
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1286/1286 [10:47<00:00,  1.99it/s]
path: codebert_snapshot/original/qt/epoch_1_step_1286.pt
  8%|█████████████████▋                                                                                                                                                                                                                   | 99/1286 [00:49<09:58,  1.98it/s]Epoch 2 / 3  the step 100-- Total loss: 18.171665
 15%|███████████████████████████████████▎                                                                                                                                                                                                | 199/1286 [01:40<09:06,  1.99it/s]Epoch 2 / 3  the step 200-- Total loss: 16.567308
 23%|█████████████████████████████████████████████████████                                                                                                                                                                               | 299/1286 [02:30<08:18,  1.98it/s]Epoch 2 / 3  the step 300-- Total loss: 14.593580
 31%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                             | 399/1286 [03:21<07:27,  1.98it/s]Epoch 2 / 3  the step 400-- Total loss: 14.432806
 39%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                           | 499/1286 [04:11<06:34,  2.00it/s]Epoch 2 / 3  the step 500-- Total loss: 9.841458
 47%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                         | 599/1286 [05:02<05:44,  1.99it/s]Epoch 2 / 3  the step 600-- Total loss: 9.188156
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                        | 699/1286 [05:52<04:47,  2.04it/s]Epoch 2 / 3  the step 700-- Total loss: 10.003463
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 799/1286 [06:42<04:05,  1.99it/s]Epoch 2 / 3  the step 800-- Total loss: 6.298316
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 899/1286 [07:32<03:12,  2.01it/s]Epoch 2 / 3  the step 900-- Total loss: 6.387031
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 999/1286 [08:23<02:24,  1.99it/s]Epoch 2 / 3  the step 1000-- Total loss: 5.756773
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1099/1286 [09:13<01:34,  1.98it/s]Epoch 2 / 3  the step 1100-- Total loss: 6.174421
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1199/1286 [10:04<00:43,  1.98it/s]Epoch 2 / 3  the step 1200-- Total loss: 5.002196
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1286/1286 [10:48<00:00,  1.98it/s]
path: codebert_snapshot/original/qt/epoch_2_step_1286.pt
  8%|█████████████████▋                                                                                                                                                                                                                   | 99/1286 [00:49<09:55,  1.99it/s]Epoch 3 / 3  the step 100-- Total loss: 3.358346
 15%|███████████████████████████████████▎                                                                                                                                                                                                | 199/1286 [01:40<09:08,  1.98it/s]Epoch 3 / 3  the step 200-- Total loss: 4.677597
 23%|█████████████████████████████████████████████████████                                                                                                                                                                               | 299/1286 [02:30<08:13,  2.00it/s]Epoch 3 / 3  the step 300-- Total loss: 5.785717
 31%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                             | 399/1286 [03:20<07:25,  1.99it/s]Epoch 3 / 3  the step 400-- Total loss: 4.291578
 39%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                           | 499/1286 [04:10<06:36,  1.99it/s]Epoch 3 / 3  the step 500-- Total loss: 3.405445
 47%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                         | 599/1286 [05:01<05:45,  1.99it/s]Epoch 3 / 3  the step 600-- Total loss: 4.656142
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                        | 699/1286 [05:51<04:54,  1.99it/s]Epoch 3 / 3  the step 700-- Total loss: 3.348965
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 799/1286 [06:42<04:05,  1.98it/s]Epoch 3 / 3  the step 800-- Total loss: 3.528819
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 899/1286 [07:32<03:14,  1.99it/s]Epoch 3 / 3  the step 900-- Total loss: 4.461198
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 999/1286 [08:23<02:24,  1.98it/s]Epoch 3 / 3  the step 1000-- Total loss: 2.600457
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 1099/1286 [09:13<01:34,  1.99it/s]Epoch 3 / 3  the step 1100-- Total loss: 2.980838
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 1199/1286 [10:04<00:43,  1.99it/s]Epoch 3 / 3  the step 1200-- Total loss: 4.763503
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1286/1286 [10:47<00:00,  1.98it/s]
path: codebert_snapshot/original/qt/epoch_3_step_1286.pt
final loss :  [66.95545959472656, 57.392677307128906, 52.16795349121094, 47.55058288574219, 48.59687423706055, 43.13911819458008, 39.67496871948242, 37.34427261352539, 34.9229736328125, 30.847562789916992, 25.57891082763672, 24.85136604309082, 18.17166519165039, 16.56730842590332, 14.59358024597168, 14.432806015014648, 9.841458320617676, 9.188156127929688, 10.003462791442871, 6.29831600189209, 6.387031078338623, 5.756772518157959, 6.1744208335876465, 5.002195835113525, 3.3583462238311768, 4.677596569061279, 5.785716533660889, 4.2915778160095215, 3.405444622039795, 4.656141757965088, 3.3489654064178467, 3.5288193225860596, 4.461197853088379, 2.6004574298858643, 2.9808382987976074, 4.763503074645996]
Traceback (most recent call last):
  File "CodeBERT.py", line 690, in <module>
    train_model(data=data, params=params)
  File "CodeBERT.py", line 474, in train_model
    write_csv(params.save_loss_path,file_name='loss.csv', data=loss_res)
AttributeError: 'Namespace' object has no attribute 'save_loss_path'
CUDA_VISIBLE_DEVICES=0 python CodeBERT.py -train -train_data ../data/openstack_data/openstack_train.pkl -save-dir codebert_snapshot/original/openstack -dictionary_data ../data/openstack_dict.pkl -dictionary_data ../data/openstack_dict.pkl
10643 10643
 max length at tokenizer: 256
 max length for code tokenizer: 128
10643 10643 10643
pad_msg_input_ids (10643, 256)
pad_msg_input_masks (10643, 256)
pad_code_input_ids (10643, 4, 128)
pad_code_input_masks (10643, 4, 128)
 15%|██████████████████████████████████▏                                                                                                                                                                                                   | 99/666 [00:50<04:41,  2.01it/s]Epoch 1 / 3  the step 100-- Total loss: 68.055122
 30%|████████████████████████████████████████████████████████████████████▍                                                                                                                                                                | 199/666 [01:40<03:53,  2.00it/s]Epoch 1 / 3  the step 200-- Total loss: 59.240837
 45%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                              | 299/666 [02:30<03:05,  1.98it/s]Epoch 1 / 3  the step 300-- Total loss: 54.649384
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                           | 399/666 [03:21<02:14,  1.99it/s]Epoch 1 / 3  the step 400-- Total loss: 50.586121
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 499/666 [04:12<01:24,  1.98it/s]Epoch 1 / 3  the step 500-- Total loss: 44.639938
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 599/666 [05:02<00:33,  2.00it/s]Epoch 1 / 3  the step 600-- Total loss: 38.945114
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 666/666 [05:36<00:00,  1.98it/s]
path: codebert_snapshot/original/openstack/epoch_1_step_666.pt
 15%|██████████████████████████████████▏                                                                                                                                                                                                   | 99/666 [00:49<04:45,  1.98it/s]Epoch 2 / 3  the step 100-- Total loss: 36.284740
 30%|████████████████████████████████████████████████████████████████████▍                                                                                                                                                                | 199/666 [01:39<03:56,  1.98it/s]Epoch 2 / 3  the step 200-- Total loss: 29.439426
 45%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                              | 299/666 [02:30<03:04,  1.99it/s]Epoch 2 / 3  the step 300-- Total loss: 23.753422
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                           | 399/666 [03:21<02:14,  1.98it/s]Epoch 2 / 3  the step 400-- Total loss: 28.091850
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 499/666 [04:11<01:23,  2.00it/s]Epoch 2 / 3  the step 500-- Total loss: 20.136629
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 599/666 [05:02<00:33,  1.99it/s]Epoch 2 / 3  the step 600-- Total loss: 20.413853
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 666/666 [05:36<00:00,  1.98it/s]
path: codebert_snapshot/original/openstack/epoch_2_step_666.pt
 15%|██████████████████████████████████▏                                                                                                                                                                                                   | 99/666 [00:49<04:45,  1.99it/s]Epoch 3 / 3  the step 100-- Total loss: 15.383637
 30%|████████████████████████████████████████████████████████████████████▍                                                                                                                                                                | 199/666 [01:40<03:56,  1.97it/s]Epoch 3 / 3  the step 200-- Total loss: 14.121572
 45%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                              | 299/666 [02:31<03:04,  1.99it/s]Epoch 3 / 3  the step 300-- Total loss: 11.754580
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                           | 399/666 [03:21<02:11,  2.03it/s]Epoch 3 / 3  the step 400-- Total loss: 8.710821
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 499/666 [04:11<01:23,  1.99it/s]Epoch 3 / 3  the step 500-- Total loss: 8.093389
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 599/666 [05:01<00:33,  1.99it/s]Epoch 3 / 3  the step 600-- Total loss: 8.975591
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 666/666 [05:35<00:00,  1.98it/s]
path: codebert_snapshot/original/openstack/epoch_3_step_666.pt
final loss :  [68.05512237548828, 59.24083709716797, 54.649383544921875, 50.58612060546875, 44.63993835449219, 38.94511413574219, 36.28474044799805, 29.43942642211914, 23.753421783447266, 28.09185028076172, 20.136629104614258, 20.41385269165039, 15.383637428283691, 14.12157154083252, 11.7545804977417, 8.710821151733398, 8.093388557434082, 8.975590705871582]
Traceback (most recent call last):
